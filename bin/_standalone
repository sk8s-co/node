#!/bin/bash
set -Eeuo pipefail
exec >&2

export KUBELET_FLAGS="\
--config=${KUBELET_CONFIG} \
--root-dir=/var/run/kube \
--cert-dir=/var/run/kube/pki \
--cluster-domain=${CLUSTER_DOMAIN} \
--cluster-dns=${CLUSTER_DNS} \
"

export CRI_DOCKERD_FLAGS="\
--container-runtime-endpoint=unix:///var/run/cri-dockerd.sock \
--cri-dockerd-root-directory=/var/run/kube/cri-dockerd \
--network-plugin=cni \
--hairpin-mode=hairpin-veth \
"

echo "Activating standalone configuration: /etc/kubernetes/kubelet/standalone.yaml" >> warns
cp /etc/kubernetes/kubelet/standalone.yaml "${KUBELET_CONFIG}"
