#!/bin/bash
set -Eeuo pipefail

# Wait for cri-dockerd socket, which is created by cri-dockerd
echo "Waiting for cri-dockerd socket..."
while [ ! -S "/var/run/cri-dockerd.sock" ]; do
    sleep 0.1
done
echo "cri-dockerd socket is ready."

echo "Starting kubelet..."
exec /srv/kubelet \
$KUBELET_FLAGS \
"$@"
